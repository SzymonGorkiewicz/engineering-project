env:                                
  contexts :                           
    - name: ZapContext                  
      urls:     
        - "http://localhost:3001"                    
      includePaths:
        - "/homepage/"
        - "/statistics/"                   
      excludePaths:                  
      authentication:
        method: form                      
        parameters:                
          hostname: "localhost"                   
          port: 3001                        
          loginPageUrl: "http://localhost:3001/login"               
          loginRequestUrl: "http://localhost:3000/auth/login"            
          loginRequestBody: '{"username":"${username}", "password":"${password}"}'         
        verification:
          method: response                    
          loggedInRegex: '"message":\\s*"Logged in succesfully"'            
          loggedOutRegex: '"message":\\s*"Logged out succesfully"'             
          pollFrequency:              
          pollUnits:                  
          pollUrl:                    
          pollPostData:               
          pollAdditionalHeaders:      
          - header:                   
            value:                     
      sessionManagement:
        method: cookie                      
        parameters:                    
          script:                      
          scriptEngine:               
      technology:
        exclude:                      
        include: [JavaScript]                     
      users:                        
      - name: zapUser                         
        credentials:                 
          username: "zapuser"                  
          password: "Hashedpassword1!"                   
  vars:                             
    username: "zapuser"      
    password: "Hashedpassword1!"     
  parameters:
    failOnError: true                       
    failOnWarning: false             
    continueOnFailure: false          
    progressToStdout: true          

jobs:
- type: activeScan                 
  parameters:
    context:                       
    policy:                         
    maxRuleDurationInMins:          
    maxScanDurationInMins:
- type: report                     
  parameters:
    template:                        
    reportDir: "/zap/wrk/"                     
    reportFile: "ZAP_DAST_SCAN"                    
    reportTitle: "DAST SCAN"                    
    reportDescription: "DAST SCAN DESC"           
    displayReport:                 
  risks:                          
    - high
    - medium
    - low
    - info
  confidences:                     
    - high
    - medium
    - low
    - falsepositive
  sections:                      
  sites:             